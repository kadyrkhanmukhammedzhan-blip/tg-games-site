<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GameMaster Mini Games</title>

  <!-- Telegram Mini Apps API (–µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–æ –≤–Ω—É—Ç—Ä–∏ Telegram) -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script> <!-- Ó®Å5Ó®Ç -->

  <style>
    :root{
      --bg:#0b1220; --card:#121a2b; --card2:#0f1728;
      --text:#e7eefc; --muted:#9fb2d6; --acc:#6aa9ff; --bad:#ff6a8a; --ok:#4cffb4;
      --border: rgba(255,255,255,.10);
    }
    *{box-sizing:border-box}
    body{
      margin:0; color:var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: radial-gradient(1200px 700px at 15% 0%, #182a55 0%, var(--bg) 55%);
    }
    a{color:inherit; text-decoration:none}
    .wrap{max-width:980px; margin:0 auto; padding:18px 14px 70px}
    .top{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding:14px 16px; border:1px solid var(--border); border-radius:18px;
      background: rgba(18,26,43,.75); backdrop-filter: blur(8px);
    }
    .brand{display:flex; align-items:center; gap:10px; font-weight:800}
    .brand .dot{width:10px; height:10px; border-radius:50%; background:var(--acc); box-shadow:0 0 24px rgba(106,169,255,.7)}
    .pill{font-size:12px; color:var(--muted); border:1px solid var(--border); padding:6px 10px; border-radius:999px}
    .grid{display:grid; grid-template-columns: 1fr; gap:12px; margin-top:12px}
    .card{
      padding:16px; border-radius:18px; border:1px solid var(--border);
      background: rgba(18,26,43,.75);
    }
    .card2{
      padding:16px; border-radius:18px; border:1px solid var(--border);
      background: rgba(15,23,40,.75);
    }
    h1{margin:6px 0 10px; font-size:30px; line-height:1.1}
    h2{margin:0 0 10px; font-size:18px}
    p{margin:0 0 10px; color:var(--muted)}
    .row{display:flex; flex-wrap:wrap; gap:10px; align-items:center}
    .btn{
      display:inline-flex; align-items:center; justify-content:center; gap:10px;
      padding:10px 14px; border-radius:12px; cursor:pointer; user-select:none;
      border:1px solid rgba(255,255,255,.14);
      background: linear-gradient(180deg, rgba(106,169,255,.18), rgba(106,169,255,.06));
      color:var(--text);
    }
    .btn.secondary{ background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.04)); }
    .btn.danger{ background: linear-gradient(180deg, rgba(255,106,138,.18), rgba(255,106,138,.06)); }
    .btn:active{transform: translateY(1px)}
    .sep{height:1px; background:rgba(255,255,255,.08); margin:12px 0}
    input{
      width:100%;
      padding:10px 12px; border-radius:12px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(9,14,24,.45); color:var(--text);
      outline:none;
    }
    .muted{color:var(--muted)}
    .small{font-size:12px; color:var(--muted)}
    .chips{display:flex; gap:8px; flex-wrap:wrap}
    .chip{
      padding:7px 10px; border-radius:999px; border:1px solid var(--border);
      background: rgba(255,255,255,.04); color:var(--muted); cursor:pointer;
      user-select:none;
    }
    .chip.active{border-color: rgba(106,169,255,.65); color:var(--text); background: rgba(106,169,255,.10)}
    .hidden{display:none !important}
    .badge{display:inline-flex; padding:4px 8px; border-radius:999px; border:1px solid var(--border); font-size:12px; color:var(--muted)}
    .center{display:flex; align-items:center; justify-content:center}
    .big{font-size:34px; font-weight:900; letter-spacing:.3px}
    .toast{
      position:fixed; left:50%; bottom:18px; transform:translateX(-50%);
      padding:10px 14px; border-radius:999px;
      border:1px solid var(--border); background: rgba(18,26,43,.92);
      color:var(--text); box-shadow: 0 10px 30px rgba(0,0,0,.35);
      opacity:0; pointer-events:none; transition: opacity .15s ease;
      max-width: calc(100vw - 28px);
      white-space: nowrap; overflow:hidden; text-overflow: ellipsis;
    }
    .toast.show{opacity:1}
    .good{color:var(--ok)}
    .bad{color:var(--bad)}
    .grid2{display:grid; grid-template-columns: 1fr 1fr; gap:10px}
    .rec{
      padding:10px 12px; border-radius:14px; border:1px solid var(--border);
      background: rgba(255,255,255,.04);
    }
    .mem{
      display:grid; grid-template-columns: repeat(4, 1fr); gap:8px; max-width:520px;
    }
    .cardtile{
      aspect-ratio: 1/1;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      display:flex; align-items:center; justify-content:center;
      font-size:28px; font-weight:900;
      user-select:none; cursor:pointer;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div class="brand"><span class="dot"></span> GameMaster Mini Games</div>
      <div class="row">
        <span class="pill" id="whoPill">Solo ‚Ä¢ Offline</span>
        <a class="btn secondary" href="https://t.me/Gamemasterbot_2bot" target="_blank" rel="noreferrer">–û—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞</a>
      </div>
    </div>

    <div class="grid">
      <div class="card" id="viewHome">
        <h1>–ú–∏–Ω–∏-–∏–≥—Ä—ã (1 –∏–≥—Ä–æ–∫)</h1>
        <p class="muted">–ë–µ–∑ –æ–Ω–ª–∞–π–Ω–∞, –±–µ–∑ –º—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä–∞. –†–µ–∫–æ—Ä–¥—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.</p>

        <div class="sep"></div>

        <h2>–†–µ–∫–æ—Ä–¥—ã</h2>
        <div class="grid2" id="recordsBox"></div>
        <div class="row" style="margin-top:10px">
          <button class="btn danger" id="clearRecords">–°–±—Ä–æ—Å–∏—Ç—å —Ä–µ–∫–æ—Ä–¥—ã</button>
        </div>

        <div class="sep"></div>

        <h2>–í—ã–±–æ—Ä –∏–≥—Ä—ã</h2>
        <div class="chips" id="gameChips">
          <div class="chip active" data-id="reaction">‚ö° –†–µ–∞–∫—Ü–∏—è</div>
          <div class="chip" data-id="guess">üéØ –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ</div>
          <div class="chip" data-id="math">üß† –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞</div>
          <div class="chip" data-id="clicker">üñ±Ô∏è –ö–ª–∏–∫–µ—Ä 10—Å</div>
          <div class="chip" data-id="memory">üß© –ü–∞–º—è—Ç—å 4√ó4</div>
        </div>

        <div class="row" style="margin-top:12px">
          <button class="btn" id="startBtn">–ó–∞–ø—É—Å—Ç–∏—Ç—å</button>
          <button class="btn secondary" id="resetBtn">–°–±—Ä–æ—Å –≤—ã–±–æ—Ä–∞</button>
        </div>
      </div>

      <div class="card hidden" id="viewGame">
        <div class="row" style="justify-content:space-between">
          <div class="row" style="gap:8px; flex-wrap:wrap">
            <span class="badge" id="badgeGame">–ò–≥—Ä–∞</span>
          </div>
          <div class="row">
            <button class="btn secondary" id="backBtn">‚Üê –ù–∞–∑–∞–¥</button>
          </div>
        </div>
        <div class="sep"></div>
        <div id="gameRoot"></div>
      </div>

      <div class="card2">
        <h2>Telegram WebApp</h2>
        <div class="small muted">
          –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤–Ω—É—Ç—Ä–∏ Telegram Mini App ‚Äî –∏–º—è –ø–æ–¥—Ç—è–Ω–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–¥—Å—Ç—Ä–æ–∏—Ç—Å—è –ø–æ–¥ —Ç–µ–º—É. Ó®Å6Ó®Ç
        </div>
      </div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

<script>
/* ---------- Telegram adapt ---------- */
(function(){
  const tg = window.Telegram?.WebApp;
  if(!tg) return;
  try{
    tg.expand?.(); // —É–¥–æ–±–Ω–µ–µ –≤–æ –≤–µ—Å—å —ç–∫—Ä–∞–Ω Ó®Å7Ó®Ç
    const u = tg.initDataUnsafe?.user;
    if(u){
      const name = u.username ? "@"+u.username : (u.first_name || "TG Player");
      document.getElementById("whoPill").textContent = `TG: ${name}`;
    } else {
      document.getElementById("whoPill").textContent = "Telegram WebApp";
    }
    // —Ü–≤–µ—Ç–∞ —Ç–µ–º—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)
    const tp = tg.themeParams || {};
    const root = document.documentElement;
    if(tp.bg_color) root.style.setProperty("--bg", tp.bg_color);
    if(tp.text_color) root.style.setProperty("--text", tp.text_color);
    if(tp.hint_color) root.style.setProperty("--muted", tp.hint_color);
    if(tp.button_color) root.style.setProperty("--acc", tp.button_color);
  }catch{}
})();

/* ---------- Helpers ---------- */
const $ = (s, el=document) => el.querySelector(s);
const $$ = (s, el=document) => Array.from(el.querySelectorAll(s));

const toastEl = $("#toast");
let toastTimer = null;
function toast(msg){
  toastEl.textContent = msg;
  toastEl.classList.add("show");
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => toastEl.classList.remove("show"), 1500);
}
function n(v){ return Number.isFinite(v) ? v : null; }

/* ---------- Records (localStorage) ---------- */
const REC_KEY = "gm_records_v1";
const defaultRec = {
  reaction_best_ms: null, // –º–µ–Ω—å—à–µ = –ª—É—á—à–µ
  guess_best_tries: null, // –º–µ–Ω—å—à–µ = –ª—É—á—à–µ
  math_best_score: null,  // –±–æ–ª—å—à–µ = –ª—É—á—à–µ
  clicker_best: null,     // –±–æ–ª—å—à–µ = –ª—É—á—à–µ
  memory_best_moves: null // –º–µ–Ω—å—à–µ = –ª—É—á—à–µ
};
function loadRec(){
  try{
    const x = JSON.parse(localStorage.getItem(REC_KEY) || "null");
    return {...defaultRec, ...(x||{})};
  }catch{ return {...defaultRec}; }
}
function saveRec(rec){ localStorage.setItem(REC_KEY, JSON.stringify(rec)); }
function renderRec(){
  const r = loadRec();
  const box = $("#recordsBox");
  const fmt = (v, suf="") => (v===null || v===undefined) ? "‚Äî" : (String(v)+suf);
  box.innerHTML = `
    <div class="rec"><div class="small">‚ö° –†–µ–∞–∫—Ü–∏—è (–ª—É—á—à–µ–µ)</div><div class="big">${fmt(r.reaction_best_ms," –º—Å")}</div></div>
    <div class="rec"><div class="small">üéØ –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ (–º–∏–Ω–∏–º—É–º)</div><div class="big">${fmt(r.guess_best_tries," –ø–æ–ø—ã—Ç–æ–∫")}</div></div>
    <div class="rec"><div class="small">üß† –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ (–º–∞–∫—Å.)</div><div class="big">${fmt(r.math_best_score,"")}</div></div>
    <div class="rec"><div class="small">üñ±Ô∏è –ö–ª–∏–∫–µ—Ä 10—Å (–º–∞–∫—Å.)</div><div class="big">${fmt(r.clicker_best,"")}</div></div>
    <div class="rec"><div class="small">üß© –ü–∞–º—è—Ç—å (–º–∏–Ω–∏–º—É–º —Ö–æ–¥–æ–≤)</div><div class="big">${fmt(r.memory_best_moves,"")}</div></div>
  `;
}
$("#clearRecords").onclick = () => {
  localStorage.removeItem(REC_KEY);
  renderRec();
  toast("–†–µ–∫–æ—Ä–¥—ã —Å–±—Ä–æ—à–µ–Ω—ã");
};

/* ---------- Navigation ---------- */
const state = { gameId: "reaction" };

function showHome(){
  $("#viewHome").classList.remove("hidden");
  $("#viewGame").classList.add("hidden");
  $("#gameRoot").innerHTML = "";
}
function showGame(){
  $("#viewHome").classList.add("hidden");
  $("#viewGame").classList.remove("hidden");
}
function setActiveChip(){
  $$("#gameChips .chip").forEach(ch => ch.classList.toggle("active", ch.dataset.id === state.gameId));
}
$$("#gameChips .chip").forEach(ch => ch.onclick = () => { state.gameId = ch.dataset.id; setActiveChip(); });

$("#resetBtn").onclick = () => { state.gameId="reaction"; setActiveChip(); toast("–°–±—Ä–æ—à–µ–Ω–æ"); };
$("#backBtn").onclick = showHome;
$("#startBtn").onclick = () => { showGame(); mountGame(state.gameId); };

function mountGame(id){
  const root = $("#gameRoot");
  root.innerHTML = "";
  if(id === "reaction") return mountReaction(root);
  if(id === "guess") return mountGuess(root);
  if(id === "math") return mountMath(root);
  if(id === "clicker") return mountClicker(root);
  if(id === "memory") return mountMemory(root);
  root.innerHTML = `<p class="muted">–ò–≥—Ä–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.</p>`;
}

/* ---------- Game: Reaction ---------- */
function mountReaction(root){
  $("#badgeGame").textContent = "‚ö° –†–µ–∞–∫—Ü–∏—è";
  let stage="idle", startAt=0, timer=null;

  root.innerHTML = `
    <h2>‚ö° –†–µ–∞–∫—Ü–∏—è</h2>
    <p class="muted">–ù–∞–∂–º–∏ —Å—Ç–∞—Ä—Ç ‚Üí –∂–¥–∏ –∑–µ–ª—ë–Ω—ã–π —Å–∏–≥–Ω–∞–ª ‚Üí –∫–ª–∏–∫–Ω–∏ –±—ã—Å—Ç—Ä–æ.</p>
    <div class="card2" style="margin-top:12px">
      <div class="row" style="justify-content:space-between">
        <button class="btn" id="rStart">–°—Ç–∞—Ä—Ç</button>
        <button class="btn secondary" id="rReset">–°–±—Ä–æ—Å</button>
      </div>
      <div style="margin-top:12px">
        <div id="rBox" class="center" style="height:180px;border-radius:18px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.04);font-size:18px;font-weight:900;user-select:none;cursor:pointer;">
          –ù–∞–∂–º–∏ ¬´–°—Ç–∞—Ä—Ç¬ª
        </div>
      </div>
      <div class="small" id="rResult" style="margin-top:10px"></div>
    </div>
  `;
  const box=$("#rBox"), result=$("#rResult");

  function setBox(text, mode){
    box.textContent=text;
    if(mode==="go"){ box.style.background="rgba(76,255,180,.12)"; box.style.borderColor="rgba(76,255,180,.35)"; }
    else if(mode==="bad"){ box.style.background="rgba(255,106,138,.12)"; box.style.borderColor="rgba(255,106,138,.35)"; }
    else { box.style.background="rgba(255,255,255,.04)"; box.style.borderColor="rgba(255,255,255,.12)"; }
  }
  function reset(){
    stage="idle"; clearTimeout(timer); timer=null; startAt=0;
    result.textContent=""; setBox("–ù–∞–∂–º–∏ ¬´–°—Ç–∞—Ä—Ç¬ª","wait");
  }
  function start(){
    reset(); stage="waiting"; setBox("–ñ–¥–∏‚Ä¶","wait");
    timer=setTimeout(()=>{ stage="go"; startAt=performance.now(); setBox("–ñ–ú–ò!","go"); }, 900 + Math.random()*2200);
  }
  $("#rStart").onclick=start;
  $("#rReset").onclick=reset;

  box.onclick=()=>{
    if(stage==="idle"){ toast("–ù–∞–∂–º–∏ ¬´–°—Ç–∞—Ä—Ç¬ª"); return; }
    if(stage==="waiting"){
      stage="done"; clearTimeout(timer); timer=null;
      setBox("–°–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ üòÖ","bad");
      result.innerHTML=`<span class="bad">–†–∞–Ω–æ!</span> –ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑.`;
      return;
    }
    if(stage==="go"){
      stage="done";
      const ms=Math.round(performance.now()-startAt);
      setBox(`–í—Ä–µ–º—è: ${ms} –º—Å`,"go");
      let rec=loadRec();
      if(rec.reaction_best_ms===null || ms < rec.reaction_best_ms){
        rec.reaction_best_ms = ms; saveRec(rec); renderRec();
        result.innerHTML = `<span class="good">${ms} –º—Å</span> ‚Äî –Ω–æ–≤—ã–π —Ä–µ–∫–æ—Ä–¥!`;
      } else {
        result.innerHTML = `<span class="good">${ms} –º—Å</span>`;
      }
      return;
    }
    if(stage==="done"){ start(); }
  };
  reset();
}

/* ---------- Game: Guess ---------- */
function mountGuess(root){
  $("#badgeGame").textContent = "üéØ –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ";
  let secret=1, tries=0;

  root.innerHTML = `
    <h2>üéØ –£–≥–∞–¥–∞–π —á–∏—Å–ª–æ</h2>
    <p class="muted">–Ø –∑–∞–≥–∞–¥–∞–ª 1..100. –í–≤–æ–¥–∏ —á–∏—Å–ª–æ ‚Äî —Å–∫–∞–∂—É –±–æ–ª—å—à–µ/–º–µ–Ω—å—à–µ.</p>
    <div class="card2" style="margin-top:12px">
      <div class="row">
        <input id="gInp" type="number" min="1" max="100" placeholder="1..100" style="flex:1; min-width:140px" />
        <button class="btn" id="gTry">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
        <button class="btn secondary" id="gNew">–ù–æ–≤–∞—è</button>
      </div>
      <div class="sep"></div>
      <div class="big" id="gHint">ü§´</div>
      <div class="small" id="gInfo" style="margin-top:10px"></div>
    </div>
  `;
  const inp=$("#gInp"), hint=$("#gHint"), info=$("#gInfo");

  function newGame(){
    secret=Math.floor(1+Math.random()*100);
    tries=0; hint.textContent="ü§´"; info.textContent="";
    inp.value=""; inp.focus();
    toast("–ó–∞–≥–∞–¥–∞–ª –Ω–æ–≤–æ–µ —á–∏—Å–ª–æ");
  }
  function check(){
    const v=Number(inp.value);
    if(!Number.isFinite(v) || v<1 || v>100){ toast("–í–≤–µ–¥–∏ 1..100"); return; }
    tries++;
    if(v===secret){
      hint.innerHTML=`<span class="good">üéâ –£–≥–∞–¥–∞–ª!</span>`;
      let rec=loadRec();
      if(rec.guess_best_tries===null || tries < rec.guess_best_tries){
        rec.guess_best_tries=tries; saveRec(rec); renderRec();
        info.innerHTML=`–ü–æ–ø—ã—Ç–æ–∫: <b>${tries}</b> ‚Äî –Ω–æ–≤—ã–π —Ä–µ–∫–æ—Ä–¥!`;
      } else {
        info.innerHTML=`–ü–æ–ø—ã—Ç–æ–∫: <b>${tries}</b>`;
      }
      toast("–ü–æ–±–µ–¥–∞!");
      return;
    }
    hint.textContent = (v<secret) ? "–ë–æ–ª—å—à–µ ‚Üë" : "–ú–µ–Ω—å—à–µ ‚Üì";
    info.textContent = `–ü–æ–ø—ã—Ç–æ–∫: ${tries}`;
  }
  $("#gTry").onclick=check;
  $("#gNew").onclick=newGame;
  inp.addEventListener("keydown",(e)=>{ if(e.key==="Enter") check(); });
  newGame();
}

/* ---------- Game: Math ---------- */
function mountMath(root){
  $("#badgeGame").textContent = "üß† –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞";
  let a=0,b=0,op="+",ans=0, score=0, timeLeft=30, timer=null;

  root.innerHTML = `
    <h2>üß† –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å</h2>
    <p class="muted">30 —Å–µ–∫—É–Ω–¥. –í–µ—Ä–Ω–æ ‚Üí +1. –ù–µ–≤–µ—Ä–Ω–æ ‚Üí –ø–æ–∫–∞–∂—É –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π.</p>
    <div class="card2" style="margin-top:12px">
      <div class="row" style="justify-content:space-between">
        <div class="badge">–û—á–∫–∏: <span id="mScore">0</span></div>
        <div class="badge">–í—Ä–µ–º—è: <span id="mTime">30</span>s</div>
      </div>
      <div class="sep"></div>
      <div class="big" id="mQ">‚Äî</div>
      <div class="row" style="margin-top:10px">
        <input id="mInp" type="number" placeholder="–û—Ç–≤–µ—Ç" style="flex:1; min-width:140px" />
        <button class="btn" id="mOk">–û–∫</button>
        <button class="btn secondary" id="mStart">–°—Ç–∞—Ä—Ç</button>
        <button class="btn danger" id="mStop">–°—Ç–æ–ø</button>
      </div>
      <div class="small" id="mInfo" style="margin-top:10px"></div>
    </div>
  `;
  const qEl=$("#mQ"), sEl=$("#mScore"), tEl=$("#mTime"), inp=$("#mInp"), info=$("#mInfo");

  function gen(){
    a=Math.floor(2+Math.random()*20);
    b=Math.floor(2+Math.random()*20);
    op=Math.random()<0.5?"+":"-";
    if(op==="-" && b>a){ const t=a;a=b;b=t; }
    ans = (op==="+") ? (a+b) : (a-b);
    qEl.textContent = `${a} ${op} ${b} = ?`;
    inp.value=""; inp.focus();
  }
  function stop(){
    clearInterval(timer); timer=null;
    info.innerHTML = `–ò—Ç–æ–≥: <b>${score}</b> –æ—á–∫–æ–≤.`;
    let rec=loadRec();
    if(rec.math_best_score===null || score > rec.math_best_score){
      rec.math_best_score=score; saveRec(rec); renderRec();
      info.innerHTML += ` <span class="good">–ù–æ–≤—ã–π —Ä–µ–∫–æ—Ä–¥!</span>`;
    }
    toast("–°—Ç–æ–ø");
  }
  function tick(){
    timeLeft--; tEl.textContent=timeLeft;
    if(timeLeft<=0) stop();
  }
  function start(){
    score=0; timeLeft=30;
    sEl.textContent=score; tEl.textContent=timeLeft;
    info.textContent="";
    gen();
    clearInterval(timer);
    timer=setInterval(tick,1000);
    toast("–ü–æ–µ—Ö–∞–ª–∏!");
  }
  function submit(){
    if(!timer){ toast("–ù–∞–∂–º–∏ ¬´–°—Ç–∞—Ä—Ç¬ª"); return; }
    const v=Number(inp.value);
    if(!Number.isFinite(v)){ toast("–í–≤–µ–¥–∏ —á–∏—Å–ª–æ"); return; }
    if(v===ans){ score++; sEl.textContent=score; toast("–í–µ—Ä–Ω–æ!"); gen(); }
    else { toast("–ù–µ–≤–µ—Ä–Ω–æ"); info.textContent=`–ü—Ä–∞–≤–∏–ª—å–Ω–æ: ${ans}`; gen(); }
  }
  $("#mStart").onclick=start;
  $("#mStop").onclick=stop;
  $("#mOk").onclick=submit;
  inp.addEventListener("keydown",(e)=>{ if(e.key==="Enter") submit(); });
  gen();
}

/* ---------- Game: Clicker 10s ---------- */
function mountClicker(root){
  $("#badgeGame").textContent = "üñ±Ô∏è –ö–ª–∏–∫–µ—Ä 10—Å";
  let score=0, timeLeft=10, timer=null, running=false;

  root.innerHTML = `
    <h2>üñ±Ô∏è –ö–ª–∏–∫–µ—Ä 10 —Å–µ–∫—É–Ω–¥</h2>
    <p class="muted">–ù–∞–∂–∏–º–∞–π –Ω–∞ –∫–Ω–æ–ø–∫—É –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ 10 —Å–µ–∫—É–Ω–¥.</p>
    <div class="card2" style="margin-top:12px">
      <div class="row" style="justify-content:space-between">
        <div class="badge">–ö–ª–∏–∫–∏: <span id="cScore">0</span></div>
        <div class="badge">–í—Ä–µ–º—è: <span id="cTime">10</span>s</div>
      </div>
      <div class="sep"></div>
      <div class="row">
        <button class="btn" id="cTap" style="flex:1; min-width:200px; height:70px; font-size:18px; font-weight:900;">–¢–ê–ü!</button>
        <button class="btn secondary" id="cStart">–°—Ç–∞—Ä—Ç</button>
        <button class="btn danger" id="cStop">–°—Ç–æ–ø</button>
      </div>
      <div class="small" id="cInfo" style="margin-top:10px"></div>
    </div>
  `;
  const sEl=$("#cScore"), tEl=$("#cTime"), info=$("#cInfo"), tap=$("#cTap");

  function end(){
    running=false; clearInterval(timer); timer=null;
    info.innerHTML = `–ò—Ç–æ–≥: <b>${score}</b>`;
    let rec=loadRec();
    if(rec.clicker_best===null || score > rec.clicker_best){
      rec.clicker_best=score; saveRec(rec); renderRec();
      info.innerHTML += ` <span class="good">–ù–æ–≤—ã–π —Ä–µ–∫–æ—Ä–¥!</span>`;
    }
    toast("–ì–æ—Ç–æ–≤–æ!");
  }
  function tick(){
    timeLeft--; tEl.textContent=timeLeft;
    if(timeLeft<=0) end();
  }
  function start(){
    score=0; timeLeft=10; running=true;
    sEl.textContent=score; tEl.textContent=timeLeft; info.textContent="";
    clearInterval(timer); timer=setInterval(tick,1000);
    toast("–°—Ç–∞—Ä—Ç!");
  }
  tap.onclick=()=>{
    if(!running){ toast("–ù–∞–∂–º–∏ ¬´–°—Ç–∞—Ä—Ç¬ª"); return; }
    score++; sEl.textContent=score;
  };
  $("#cStart").onclick=start;
  $("#cStop").onclick=end;
}

/* ---------- Game: Memory 4x4 ---------- */
function mountMemory(root){
  $("#badgeGame").textContent = "üß© –ü–∞–º—è—Ç—å 4√ó4";
  const icons = ["üçí","üçã","üçá","üçâ","üçì","ü•ù","üçë","üçç"]; // 8 –ø–∞—Ä
  let deck = [...icons, ...icons].sort(()=>Math.random()-0.5);
  let open = []; // indices
  let matched = new Set();
  let moves = 0;
  let lock = false;

  root.innerHTML = `
    <h2>üß© –ü–∞–º—è—Ç—å 4√ó4</h2>
    <p class="muted">–û—Ç–∫—Ä–æ–π 2 –∫–∞—Ä—Ç–æ—á–∫–∏. –ï—Å–ª–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ ‚Äî –æ—Å—Ç–∞—é—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç—ã–º–∏.</p>
    <div class="card2" style="margin-top:12px">
      <div class="row" style="justify-content:space-between">
        <div class="badge">–•–æ–¥—ã: <span id="mmMoves">0</span></div>
        <button class="btn secondary" id="mmNew">–ù–æ–≤–∞—è</button>
      </div>
      <div class="sep"></div>
      <div class="mem" id="mmGrid"></div>
      <div class="small" id="mmInfo" style="margin-top:10px"></div>
    </div>
  `;
  const grid=$("#mmGrid"), mEl=$("#mmMoves"), info=$("#mmInfo");

  function render(){
    mEl.textContent = moves;
    grid.innerHTML = "";
    for(let i=0;i<deck.length;i++){
      const isOpen = open.includes(i) || matched.has(i);
      const tile = document.createElement("div");
      tile.className = "cardtile";
      tile.textContent = isOpen ? deck[i] : "‚Ä¢";
      tile.onclick = () => flip(i);
      grid.appendChild(tile);
    }
  }
  function win(){
    info.innerHTML = `<span class="good">–ì–æ—Ç–æ–≤–æ!</span> –•–æ–¥–æ–≤: <b>${moves}</b>`;
    let rec=loadRec();
    if(rec.memory_best_moves===null || moves < rec.memory_best_moves){
      rec.memory_best_moves = moves; saveRec(rec); renderRec();
      info.innerHTML += ` ‚Äî <span class="good">–ù–æ–≤—ã–π —Ä–µ–∫–æ—Ä–¥!</span>`;
    }
    toast("–ü–æ–±–µ–¥–∞!");
  }
  function flip(i){
    if(lock) return;
    if(matched.has(i)) return;
    if(open.includes(i)) return;

    open.push(i);
    if(open.length === 2) moves++;
    render();

    if(open.length < 2) return;

    const [a,b] = open;
    if(deck[a] === deck[b]){
      matched.add(a); matched.add(b);
      open = [];
      render();
      if(matched.size === deck.length) win();
      return;
    }

    lock = true;
    setTimeout(()=>{
      open = [];
      lock = false;
      render();
    }, 550);
  }

  $("#mmNew").onclick = () => {
    deck = [...icons, ...icons].sort(()=>Math.random()-0.5);
    open=[]; matched=new Set(); moves=0; lock=false; info.textContent="";
    render();
    toast("–ù–æ–≤–∞—è –∏–≥—Ä–∞");
  };

  render();
}

/* init */
renderRec();
showHome();
setActiveChip();
</script>
</body>
</html>
